{"version":3,"file":"bundle.9395.js","mappings":";;;;;;AAAa;AACb,kBAAkB,wCAA+C;AACjE,aAAa,mCAA2B;AACxC,qBAAqB,oDAAqC;AAC1D,YAAY,2CAAyB;AACrC,aAAa,mBAAO,CAAC,KAAW;AAChC;;AAEA;AACA,sBAAsB,oBAAoB;AAC1C;;AAEA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,oBAAoB;AACzE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,mBAAmB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe,QAAQ;AACvB,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA,8BAA8B;AAC9B;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,EAAE;AACvB;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,gCAAgC,uDAAuD;;AAEvF;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,gEAAgE,GAAG;AACnE,wBAAwB,EAAE;AAC1B,UAAU;AACV;AACA,sDAAsD,EAAE;AACxD;AACA;AACA;AACA;AACA;;;AAGA;AACA,0BAA0B,oCAAoC;AAC9D,yBAAyB,iCAAiC;AAC1D,wBAAwB,uCAAuC;AAC/D,oBAAoB,oCAAoC;AACxD;AACA;AACA,qBAAqB,oCAAoC;AACzD,qBAAqB,gDAAgD;AACrE,iBAAiB,wCAAwC,EAAE;AAC3D,+BAA+B,gDAAgD;AAC/E;AACA;AACA;AACA;AACA,6BAA6B,+CAA+C;AAC5E,6BAA6B,mDAAmD;AAChF,uBAAuB,gDAAgD;AACvE,2BAA2B,gDAAgD;AAC3E,wBAAwB,gDAAgD;;AAExE,6BAA6B,uCAAuC;AACpE,2BAA2B,uCAAuC;AAClE;AACA,0BAA0B,6CAA6C;AACvE;AACA,6BAA6B;AAC7B;;AAEA;AACA,gBAAgB;AAChB;AACA,WAAW,QAAQ;AACnB,YAAY;AACZ;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,SAAS;AACpB;AACA,sBAAsB;AACtB;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,YAAY;AACZ;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,0BAA0B,mBAAmB;AAC7C,SAAS;AACT;AACA;AACA,CAAC;;AAED,eAAe;AACf;AACA;AACA;AACA;AACA","sources":["webpack://ace-playground/./node_modules/ace-code/src/ext/emmet.js"],"sourcesContent":["\"use strict\";\nvar HashHandler = require(\"../keyboard/hash_handler\").HashHandler;\nvar Editor = require(\"../editor\").Editor;\nvar snippetManager = require(\"../snippets\").snippetManager;\nvar Range = require(\"../range\").Range;\nvar config = require(\"../config\");\nvar emmet, emmetPath;\n\n/**\n * Implementation of {@link IEmmetEditor} interface for Ace\n */\n\nclass AceEmmetEditor {\n    /**\n     * @param {Editor} editor\n     */\n    setupContext(editor) {\n        this.ace = editor;\n        this.indentation = editor.session.getTabString();\n        if (!emmet)\n            emmet = window[\"emmet\"];\n        var resources = emmet.resources || emmet.require(\"resources\");\n        resources.setVariable(\"indentation\", this.indentation);\n        this.$syntax = null;\n        this.$syntax = this.getSyntax();\n    }\n    /**\n     * Returns character indexes of selected text: object with <code>start</code>\n     * and <code>end</code> properties. If there's no selection, should return\n     * object with <code>start</code> and <code>end</code> properties referring\n     * to current caret position\n     * @return {Object}\n     * @example\n     * var selection = editor.getSelectionRange();\n     * alert(selection.start + ', ' + selection.end);\n     */\n    getSelectionRange() {\n        // TODO should start be caret position instead?\n        var range = this.ace.getSelectionRange();\n        var doc = this.ace.session.doc;\n        return {\n            start: doc.positionToIndex(range.start),\n            end: doc.positionToIndex(range.end)\n        };\n    }\n\n    /**\n     * Creates selection from <code>start</code> to <code>end</code> character\n     * indexes. If <code>end</code> is ommited, this method should place caret\n     * and <code>start</code> index\n     * @param {Number} start\n     * @param {Number} [end]\n     * @example\n     * editor.createSelection(10, 40);\n     *\n     * //move caret to 15th character\n     * editor.createSelection(15);\n     */\n    createSelection(start, end) {\n        var doc = this.ace.session.doc;\n        this.ace.selection.setRange({\n            start: doc.indexToPosition(start),\n            end: doc.indexToPosition(end)\n        });\n    }\n\n    /**\n     * Returns current line's start and end indexes as object with <code>start</code>\n     * and <code>end</code> properties\n     * @return {Object}\n     * @example\n     * var range = editor.getCurrentLineRange();\n     * alert(range.start + ', ' + range.end);\n     */\n    getCurrentLineRange() {\n        var ace = this.ace;\n        var row = ace.getCursorPosition().row;\n        var lineLength = ace.session.getLine(row).length;\n        var index = ace.session.doc.positionToIndex({row: row, column: 0});\n        return {\n            start: index,\n            end: index + lineLength\n        };\n    }\n\n    /**\n     * Returns current caret position\n     * @return {Number|null}\n     */\n    getCaretPos(){\n        var pos = this.ace.getCursorPosition();\n        return this.ace.session.doc.positionToIndex(pos);\n    }\n\n    /**\n     * Set new caret position\n     * @param {Number} index Caret position\n     */\n    setCaretPos(index){\n        var pos = this.ace.session.doc.indexToPosition(index);\n        this.ace.selection.moveToPosition(pos);\n    }\n\n    /**\n     * Returns content of current line\n     * @return {String}\n     */\n    getCurrentLine() {\n        var row = this.ace.getCursorPosition().row;\n        return this.ace.session.getLine(row);\n    }\n\n    /**\n     * Replace editor's content or it's part (from <code>start</code> to\n     * <code>end</code> index). If <code>value</code> contains\n     * <code>caret_placeholder</code>, the editor will put caret into\n     * this position. If you skip <code>start</code> and <code>end</code>\n     * arguments, the whole target's content will be replaced with\n     * <code>value</code>.\n     *\n     * If you pass <code>start</code> argument only,\n     * the <code>value</code> will be placed at <code>start</code> string\n     * index of current content.\n     *\n     * If you pass <code>start</code> and <code>end</code> arguments,\n     * the corresponding substring of current target's content will be\n     * replaced with <code>value</code>.\n     * @param {String} value Content you want to paste\n     * @param {Number} [start] Start index of editor's content\n     * @param {Number} [end] End index of editor's content\n     * @param {Boolean} [noIndent] Do not auto indent <code>value</code>\n     */\n    replaceContent(value, start, end, noIndent) {\n        if (end == null)\n            end = start == null ? this.getContent().length : start;\n        if (start == null)\n            start = 0;        \n        \n        var editor = this.ace;\n        var doc = editor.session.doc;\n        var range = Range.fromPoints(doc.indexToPosition(start), doc.indexToPosition(end));\n        editor.session.remove(range);\n        \n        range.end = range.start;\n        //editor.selection.setRange(range);\n        \n        value = this.$updateTabstops(value);\n        snippetManager.insertSnippet(editor, value);\n    }\n\n    /**\n     * Returns editor's content\n     * @return {String}\n     */\n    getContent(){\n        return this.ace.getValue();\n    }\n\n    /**\n     * Returns current editor's syntax mode\n     * @return {String}\n     */\n    getSyntax() {\n        if (this.$syntax)\n            return this.$syntax;\n        var syntax = this.ace.session.$modeId.split(\"/\").pop();\n        if (syntax == \"html\" || syntax == \"php\") {\n            var cursor = this.ace.getCursorPosition();\n            /**@type {string | string[]} */\n            var state = this.ace.session.getState(cursor.row);\n            if (typeof state != \"string\")\n                state = state[0];\n            if (state) {\n                state = state.split(\"-\");\n                if (state.length > 1)\n                    syntax = state[0];\n                else if (syntax == \"php\")\n                    syntax = \"html\";\n            }\n        }\n        return syntax;\n    }\n\n    /**\n     * Returns current output profile name (@see emmet#setupProfile)\n     * @return {String}\n     */\n    getProfileName() {\n        var resources = emmet.resources || emmet.require(\"resources\");\n        switch (this.getSyntax()) {\n          case \"css\": return \"css\";\n          case \"xml\":\n          case \"xsl\":\n            return \"xml\";\n          case \"html\":\n            var profile = resources.getVariable(\"profile\");\n            // no forced profile, guess from content html or xhtml?\n            if (!profile)\n                profile = this.ace.session.getLines(0,2).join(\"\").search(/<!DOCTYPE[^>]+XHTML/i) != -1 ? \"xhtml\": \"html\";\n            return profile;\n          default:\n            var mode = this.ace.session.$mode;\n            return mode.emmetConfig && mode.emmetConfig.profile || \"xhtml\";\n        }\n    }\n\n    /**\n     * Ask user to enter something\n     * @param {String} title Dialog title\n     * @return {String} Entered data\n     * @since 0.65\n     */\n    prompt(title) {\n        return prompt(title); // eslint-disable-line no-alert\n    }\n\n    /**\n     * Returns current selection\n     * @return {String}\n     * @since 0.65\n     */\n    getSelection() {\n        return this.ace.session.getTextRange();\n    }\n\n    /**\n     * Returns current editor's file path\n     * @return {String}\n     * @since 0.65\n     */\n    getFilePath() {\n        return \"\";\n    }\n    \n    // update tabstops: make sure all caret placeholders are unique\n    // by default, abbreviation parser generates all unlinked (un-mirrored)\n    // tabstops as ${0}, so we have upgrade all caret tabstops with unique\n    // positions but make sure that all other tabstops are not linked accidentally\n    // based on https://github.com/sergeche/emmet-sublime/blob/master/editor.js#L119-L171\n    /**\n     * @param {string} value\n     */\n    $updateTabstops(value) {\n        var base = 1000;\n        var zeroBase = 0;\n        var lastZero = null;\n        var ts = emmet.tabStops || emmet.require('tabStops');\n        var resources = emmet.resources || emmet.require(\"resources\");\n        var settings = resources.getVocabulary(\"user\");\n        var tabstopOptions = {\n            tabstop: function(data) {\n                var group = parseInt(data.group, 10);\n                var isZero = group === 0;\n                if (isZero)\n                    group = ++zeroBase;\n                else\n                    group += base;\n\n                var placeholder = data.placeholder;\n                if (placeholder) {\n                    // recursively update nested tabstops\n                    placeholder = ts.processText(placeholder, tabstopOptions);\n                }\n\n                var result = '${' + group + (placeholder ? ':' + placeholder : '') + '}';\n\n                if (isZero) {\n                    lastZero = [data.start, result];\n                }\n\n                return result;\n            },\n            escape: function(ch) {\n                if (ch == '$') return '\\\\$';\n                if (ch == '\\\\') return '\\\\\\\\';\n                return ch;\n            }\n        };\n\n        value = ts.processText(value, tabstopOptions);\n\n        if (settings.variables['insert_final_tabstop'] && !/\\$\\{0\\}$/.test(value)) {\n            value += '${0}';\n        } else if (lastZero) {\n            var common = emmet.utils ? emmet.utils.common : emmet.require('utils');\n            value = common.replaceSubstring(value, '${0}', lastZero[0], lastZero[1]);\n        }\n        \n        return value;\n    }\n}\n\n\nvar keymap = {\n    expand_abbreviation: {\"mac\": \"ctrl+alt+e\", \"win\": \"alt+e\"},\n    match_pair_outward: {\"mac\": \"ctrl+d\", \"win\": \"ctrl+,\"},\n    match_pair_inward: {\"mac\": \"ctrl+j\", \"win\": \"ctrl+shift+0\"},\n    matching_pair: {\"mac\": \"ctrl+alt+j\", \"win\": \"alt+j\"},\n    next_edit_point: \"alt+right\",\n    prev_edit_point: \"alt+left\",\n    toggle_comment: {\"mac\": \"command+/\", \"win\": \"ctrl+/\"},\n    split_join_tag: {\"mac\": \"shift+command+'\", \"win\": \"shift+ctrl+`\"},\n    remove_tag: {\"mac\": \"command+'\", \"win\": \"shift+ctrl+;\"},\n    evaluate_math_expression: {\"mac\": \"shift+command+y\", \"win\": \"shift+ctrl+y\"},\n    increment_number_by_1: \"ctrl+up\",\n    decrement_number_by_1: \"ctrl+down\",\n    increment_number_by_01: \"alt+up\",\n    decrement_number_by_01: \"alt+down\",\n    increment_number_by_10: {\"mac\": \"alt+command+up\", \"win\": \"shift+alt+up\"},\n    decrement_number_by_10: {\"mac\": \"alt+command+down\", \"win\": \"shift+alt+down\"},\n    select_next_item: {\"mac\": \"shift+command+.\", \"win\": \"shift+ctrl+.\"},\n    select_previous_item: {\"mac\": \"shift+command+,\", \"win\": \"shift+ctrl+,\"},\n    reflect_css_value: {\"mac\": \"shift+command+r\", \"win\": \"shift+ctrl+r\"},\n\n    encode_decode_data_url: {\"mac\": \"shift+ctrl+d\", \"win\": \"ctrl+'\"},\n    // update_image_size: {\"mac\": \"shift+ctrl+i\", \"win\": \"ctrl+u\"},\n    // expand_as_you_type: \"ctrl+alt+enter\",\n    // wrap_as_you_type: {\"mac\": \"shift+ctrl+g\", \"win\": \"shift+ctrl+g\"},\n    expand_abbreviation_with_tab: \"Tab\",\n    wrap_with_abbreviation: {\"mac\": \"shift+ctrl+a\", \"win\": \"shift+ctrl+a\"}\n};\n\nvar editorProxy = new AceEmmetEditor();\nexports.commands = new HashHandler();\n/**\n * @param {Editor} editor\n * @return {number|boolean}\n */\nexports.runEmmetCommand = function runEmmetCommand(editor) {\n    if (this.action == \"expand_abbreviation_with_tab\") {\n        if (!editor.selection.isEmpty())\n            return false;\n        var pos = editor.selection.lead;\n        var token = editor.session.getTokenAt(pos.row, pos.column);\n        if (token && /\\btag\\b/.test(token.type))\n            return false;\n    }\n    try {\n        editorProxy.setupContext(editor);\n        var actions = emmet.actions || emmet.require(\"actions\");\n        \n        if (this.action == \"wrap_with_abbreviation\") {\n            // without setTimeout prompt doesn't work on firefox\n            return setTimeout(function() {\n                actions.run(\"wrap_with_abbreviation\", editorProxy);\n            }, 0);\n        }\n        \n        var result = actions.run(this.action, editorProxy);\n    } catch(e) {\n        if (!emmet) {\n            var loading = exports.load(runEmmetCommand.bind(this, editor));\n            if (this.action == \"expand_abbreviation_with_tab\")\n                return false;\n            return loading;\n        }\n        editor._signal(\"changeStatus\", typeof e == \"string\" ? e : e.message);\n        config.warn(e);\n        result = false;\n    }\n    return result;\n};\n\nfor (var command in keymap) {\n    exports.commands.addCommand({\n        name: \"emmet:\" + command,\n        action: command,\n        bindKey: keymap[command],\n        exec: exports.runEmmetCommand,\n        multiSelectAction: \"forEach\"\n    });\n}\n\n/**\n * @param {Editor} editor\n * @param {boolean} [enabled]\n */\nexports.updateCommands = function(editor, enabled) {\n    if (enabled) {\n        editor.keyBinding.addKeyboardHandler(exports.commands);\n    } else {\n        editor.keyBinding.removeKeyboardHandler(exports.commands);\n    }\n};\n\nexports.isSupportedMode = function(mode) {\n    if (!mode) return false;\n    if (mode.emmetConfig) return true;\n    var id = mode.$id || mode;\n    return /css|less|scss|sass|stylus|html|php|twig|ejs|handlebars/.test(id);\n};\n\n/**\n * @param {Editor} editor\n * @param {string} command\n * @return {boolean}\n */\nexports.isAvailable = function(editor, command) {\n    if (/(evaluate_math_expression|expand_abbreviation)$/.test(command))\n        return true;\n    var mode = editor.session.$mode;\n    var isSupported = exports.isSupportedMode(mode);\n    if (isSupported && mode.$modes) {\n        // TODO refactor mode delegates to make this simpler\n        try {\n            editorProxy.setupContext(editor);\n            if (/js|php/.test(editorProxy.getSyntax()))\n                isSupported = false;\n        } catch(e) {}\n    }\n    return isSupported;\n};\n\nvar onChangeMode = function(e, target) {\n    var editor = target;\n    if (!editor)\n        return;\n    var enabled = exports.isSupportedMode(editor.session.$mode);\n    if (e.enableEmmet === false)\n        enabled = false;\n    if (enabled)\n        exports.load();\n    exports.updateCommands(editor, enabled);\n};\n\nexports.load = function(cb) {\n    if (typeof emmetPath !== \"string\") {\n        config.warn(\"script for emmet-core is not loaded\");\n        return false;\n    }\n    config.loadModule(emmetPath, function() {\n        emmetPath = null;\n        cb && cb();\n    });\n    return true;\n};\n\nexports.AceEmmetEditor = AceEmmetEditor;\nconfig.defineOptions(Editor.prototype, \"editor\", {\n    enableEmmet: {\n        set: function(val) {\n            this[val ? \"on\" : \"removeListener\"](\"changeMode\", onChangeMode);\n            onChangeMode({enableEmmet: !!val}, this);\n        },\n        value: true\n    }\n});\n\nexports.setCore = function(e) {\n    if (typeof e == \"string\")\n       emmetPath = e;\n    else\n       emmet = e;\n};\n"],"names":[],"sourceRoot":""}